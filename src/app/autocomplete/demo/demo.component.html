<pre>{{ text | json }}</pre>

<input
  #inputRef
  cdkOverlayOrigin
  #dropDownOrigin="cdkOverlayOrigin"
  autocomplete="off"
  [value]="text"
  (input)="text = inputRef.value"
  [autocompleteInput]="autocomplete"
  #autocompleteInput="autocompleteInput"
/>

<autocomplete-suggestions #autocomplete [datalist]="datalist" [inputMinLength]="inputMinLength" [(inputValue)]="text">
  <ng-template
    *ngIf="autocomplete.suggestions$ | async as suggestions"
    cdkConnectedOverlay
    [cdkConnectedOverlayOrigin]="dropDownOrigin"
    [cdkConnectedOverlayOpen]="suggestions.length > 0 && autocomplete.shouldDisplaySuggestions"
  >
    <div class="autocomplete-input__suggestions" [style.width]="autocompleteInput.inputWidthPx">
      <div
        autocompleteSuggestion
        *ngFor="let suggestion of suggestions; index as suggestionIndex"
        class="autocomplete-input__suggestion"
        [class.autocomplete-input__suggestion--focused]="suggestionIndex === autocomplete.focusedSuggestionIndex"
        (click)="autocomplete.selectSuggestion(suggestion)"
      >
        <span [innerHTML]="suggestion | autocompleteHighlightSuggestion: autocomplete.inputValue"></span>

        <span *ngIf="suggestion === autocomplete.inputValue" class="autocomplete-input__suggestion-check">&check;</span>
      </div>
    </div>
  </ng-template>
</autocomplete-suggestions>
